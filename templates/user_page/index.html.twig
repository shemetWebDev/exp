{% extends 'base.html.twig' %}
{% block title %}Создать страницу
{% endblock %}

{% block body %}
	<section class="wizard">
		<div class="container">
			<h1 class="wizard__title">Создание страницы</h1>

			<div class="wizard__notice" role="status" aria-live="polite">
				<strong>Условия видимости:</strong>
				Новая страница будет видима
				<b>{{ trial_hours }}
					часов</b>
				(до
				<b>{{ trialEndsAt|date('d.m.Y H:i') }}</b>). После — страница скроется до подтверждения оплаты.
			</div>

			{{ form_start(form, { attr: { id: 'userPageForm', class: 'wizard__form', novalidate: 'novalidate' } }) }}
			{# сервер управляет шагом #}
			<input type="hidden" name="step" value="{{ step|default(0) }}"/>

			{% include 'user_page/steps/_head.html.twig' with { step: step|default(0) } %}

			<div id="wizardAlert" class="wizard-alert" {{ form.vars.errors|length ? '' : 'hidden' }}>
				Проверьте выделенные поля на этом шаге.
			</div>

			<div class="wizard-content">
				{% include 'user_page/steps/_step_basic.html.twig'   with { form: form, active: step == 0 } %}
				{% include 'user_page/steps/_step_images.html.twig'  with { form: form, active: step == 1, stored: stored|default({}) } %}
				{% include 'user_page/steps/_step_benefits.html.twig' with { form: form, active: step == 2 } %}
				{% include 'user_page/steps/_step_contacts.html.twig' with { form: form, active: step == 3 } %}
				{% include 'user_page/steps/_step_map.html.twig'     with { form: form, active: step == 4 } %}
			</div>

			<div class="wizard-actions" aria-label="Навигация по шагам">
				<button type="submit" name="nav" value="prev" class="btn btn--soft btn--lg" {{ step == 0 ? 'disabled' }}>
					Назад
				</button>
				{% if step < 4 %}
					<button type="submit" name="nav" value="next" class="btn btn--primary btn--lg">Далее</button>
				{% else %}
					<button type="submit" name="nav" value="submit" class="btn btn--primary btn--lg">Создать страницу</button>
				{% endif %}
			</div>
			{{ form_end(form) }}
		</div>

		{# Leaflet с CDN #}
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

		{# ваш собранный фронт (Encore/Vite). Если без сборки — положите файл в public/build и подключите как asset() #}
		<script defer src="{{ asset('js/user_page_wizard.js') }}"></script>
	</section>
{% endblock %}
