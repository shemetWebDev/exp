{# templates/user_page/show.html.twig #}
<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">

		<title>{{ userPage.title|default('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ–º–ø–∞–Ω–∏–∏') }}</title>
		<meta name="description" content="{{ userPage.subtitle|default(userPage.companyName|default('')) }}">
		<meta
		name="keywords" content="{{ userPage.keywords|default('') }}">

		{# OG/Twitter #}
		{% set ogImage = userPage.bannerImg ? asset('uploads/' ~ userPage.bannerImg) : (userPage.image ? asset('uploads/' ~ userPage.image) : null) %}
		<meta property="og:type" content="website">
		{% if userPage.title %}<meta property="og:title" content="{{ userPage.title }}">
		{% endif %}
		{% if userPage.subtitle %}<meta property="og:description" content="{{ userPage.subtitle }}">
		{% endif %}
		{% if ogImage %}<meta property="og:image" content="{{ ogImage }}">
		{% endif %}
		<meta name="twitter:card" content="summary_large_image">
		{% if userPage.title %}<meta name="twitter:title" content="{{ userPage.title }}">
		{% endif %}
		{% if userPage.subtitle %}<meta name="twitter:description" content="{{ userPage.subtitle }}">
		{% endif %}
		{% if ogImage %}<meta name="twitter:image" content="{{ ogImage }}">
		{% endif %}

		{% block stylesheets %}
			{{ encore_entry_link_tags('app') }}
		{% endblock %}
		<link rel="stylesheet" href="{{ asset('css/user_page_public.css') }}">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
	</head>

	{# —Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è JS —á–µ—Ä–µ–∑ data-theme #}
	<body class="page userpage" data-theme="auto">
		<header class="header" id="top">
			<div class="container header__row">
				<button class="nav__toggle" id="navToggle" aria-label="–ú–µ–Ω—é" aria-controls="navMenu" aria-expanded="false">‚ò∞</button>

				{% set hasAdvantages = userPage.advantageOne or userPage.advantageTwoo or userPage.advantageThree %}
				{% set hasContacts   = userPage.phone or userPage.email or userPage.adress %}
				{% set hasMap        = userPage.mapPosition is defined and userPage.mapPosition is not empty %}

				<nav class="nav" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
					<ul class="nav__list" id="navMenu">
						<li class="nav__item">
							<a class="nav__link" href="#about">–û –Ω–∞—Å</a>
						</li>
						{% if hasAdvantages %}
							<li class="nav__item">
								<a class="nav__link" href="#advantages">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</a>
							</li>
						{% endif %}
						{% if hasContacts %}
							<li class="nav__item">
								<a class="nav__link" href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
							</li>
						{% endif %}
						{% if hasMap %}
							<li class="nav__item">
								<a class="nav__link" href="#map">–ö–∞—Ä—Ç–∞</a>
							</li>
						{% endif %}
					</ul>
				</nav>

				<div class="header__actions">
					<button class="theme-toggle" id="themeToggle" aria-label="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É" aria-pressed="false" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">üåì</button>
					<a class="header__back" href="/">‚Üê –ù–∞ –ø–ª–æ—â–∞–¥–∫—É</a>
				</div>
			</div>
		</header>

		{# HERO: —Ñ–æ–Ω –∑–∞–¥–∞—ë–º –ò–ù–õ–ê–ô–ù (–≥—Ä–∞–¥–∏–µ–Ω—Ç + —Ñ–æ—Ç–æ), –±–µ–∑ –ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç–æ–≤ #}
		{% set bannerUrl = userPage.bannerImg ? asset('uploads/' ~ userPage.bannerImg) : null %}
		<section id="hero" class="hero{{ bannerUrl ? ' hero--bg' }}" {% if bannerUrl %} style="background-image:
			                 linear-gradient(180deg, rgba(6,8,15,0.55) 0%, rgba(6,8,15,0.85) 100%),
			                 url('{{ bannerUrl|e('html_attr') }}');" {% endif %}>
			<div class="container hero__inner">
				<div class="hero__content reveal">
					<h1 class="hero__title">{{ userPage.title|default('') }}</h1>
					{% if userPage.subtitle %}
						<p class="hero__lead">{{ userPage.subtitle }}</p>
					{% endif %}
					<div class="hero__cta">
						{% if userPage.phone %}
							<a class="btn btn--primary" href="tel:{{ userPage.phone|replace({' ':''}) }}">–ü–æ–∑–≤–æ–Ω–∏—Ç—å</a>
						{% endif %}
						{% if userPage.email %}
							<a class="btn btn--soft" href="mailto:{{ userPage.email }}">–ù–∞–ø–∏—Å–∞—Ç—å</a>
						{% endif %}
					</div>
				</div>

				{% if userPage.image %}
					<picture class="hero__media reveal">
						<img src="{{ asset('uploads/' ~ userPage.image) }}" alt="{{ userPage.companyName|default(userPage.title)|default('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ') }}" loading="lazy" class="hero__img img-loading">
					</picture>
				{% endif %}
			</div>
		</section>

		<section id="about" class="section about">
			<div class="container about__grid">
				{% if userPage.image %}
					<div class="about__media reveal">
						<img src="{{ asset('uploads/' ~ userPage.image) }}" alt="{{ userPage.companyName|default('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∫–æ–º–ø–∞–Ω–∏–∏') }}" loading="lazy" class="about__img img-loading">
					</div>
				{% endif %}

				<div class="about__body reveal">
					<h2 class="section__title">–û –Ω–∞—Å</h2>
					<p class="about__text">{{ userPage.companyName|default('–ù–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è') }}</p>

					{% if userPage.keywords %}
						<div class="tags" aria-label="–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞">
							{% for kw in userPage.keywords|split(',')|slice(0,8) %}
								{% set k = kw|trim %}
								{% if k %}
									<span class="tag">{{ k }}</span>
								{% endif %}
							{% endfor %}
						</div>
					{% endif %}
				</div>
			</div>
		</section>

		{% if hasAdvantages %}
			<section id="advantages" class="section advantages">
				<div class="container">
					<h2 class="section__title">–ù–∞—à–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h2>
					<div class="cards">
						{% if userPage.advantageOne %}
							<article class="card reveal">
								<div class="card__icon" aria-hidden="true">‚òÖ</div>
								<h3 class="card__title">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ</h3>
								<p class="card__text">{{ userPage.advantageOne }}</p>
							</article>
						{% endif %}
						{% if userPage.advantageTwoo %}
							<article class="card reveal">
								<div class="card__icon" aria-hidden="true">‚òÖ</div>
								<h3 class="card__title">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ</h3>
								<p class="card__text">{{ userPage.advantageTwoo }}</p>
							</article>
						{% endif %}
						{% if userPage.advantageThree %}
							<article class="card reveal">
								<div class="card__icon" aria-hidden="true">‚òÖ</div>
								<h3 class="card__title">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ</h3>
								<p class="card__text">{{ userPage.advantageThree }}</p>
							</article>
						{% endif %}
					</div>
				</div>
			</section>
		{% endif %}

		{# CONTACTS + MAP + ROUTE BUTTONS #}
		{% set coords = hasMap ? userPage.mapPosition|split(',') : [] %}
		{% set lat = hasMap and coords|length >= 2 ? coords[0]|trim : null %}
		{% set lng = hasMap and coords|length >= 2 ? coords[1]|trim : null %}
		{% set dest = lat and lng ? (lat ~ ',' ~ lng) : (userPage.adress|default('')) %}
		{% set q = dest ? dest|url_encode : '' %}

		{% if hasContacts or hasMap %}
			<section id="contacts" class="section contacts">
				<div class="container contacts__grid">
					<div class="contacts__info reveal">
						<h2 class="section__title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
						<ul class="list">
							{% if userPage.phone %}
								<li class="list__item">
									<span class="list__label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
									<a href="tel:{{ userPage.phone|replace({' ':''}) }}">{{ userPage.phone }}</a>
								</li>
							{% endif %}
							{% if userPage.email %}
								<li class="list__item">
									<span class="list__label">Email:</span>
									<a href="mailto:{{ userPage.email }}">{{ userPage.email }}</a>
								</li>
							{% endif %}
							{% if userPage.adress %}
								<li class="list__item">
									<span class="list__label">–ê–¥—Ä–µ—Å:</span>
									<span>{{ userPage.adress }}</span>
								</li>
							{% endif %}
						</ul>

						{# –µ—Å–ª–∏ –∫–∞—Ä—Ç—ã –Ω–µ—Ç, –Ω–æ –∞–¥—Ä–µ—Å/–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –µ—Å—Ç—å ‚Äî –ø–æ–∫–∞–∂–µ–º –∫–Ω–æ–ø–∫–∏ —Ç—É—Ç #}
						{% if (not hasMap) and q %}
							<div class="map-actions" aria-label="–ö–∞–∫ –¥–æ–±—Ä–∞—Ç—å—Å—è">
								<a class="btn btn--soft" target="_blank" rel="noopener" href="https://www.google.com/maps/dir/?api=1&destination={{ q }}">Google Maps</a>
								<a class="btn btn--soft" target="_blank" rel="noopener" href="https://maps.apple.com/?daddr={{ q }}">Apple Maps</a>
								<a class="btn btn--soft" target="_blank" rel="noopener" href="https://yandex.ru/maps/?rtext=~{{ q }}&rtt=auto">–Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã</a>
							</div>
						{% endif %}
					</div>

					{% if hasMap %}
						<div class="contacts__map reveal">
							<div id="map" class="map" data-coords="{{ lat ~ ',' ~ lng }}">
								<div class="map__skeleton">–ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ä—Ç—É‚Ä¶</div>
							</div>
							{% if q %}
								<div class="map-actions" aria-label="–ö–∞–∫ –¥–æ–±—Ä–∞—Ç—å—Å—è">
									<a class="btn btn--soft" target="_blank" rel="noopener" href="https://www.google.com/maps/dir/?api=1&destination={{ q }}">–û—Ç–∫—Ä—ã—Ç—å –≤ Google Maps</a>
									<a class="btn btn--soft" target="_blank" rel="noopener" href="https://maps.apple.com/?daddr={{ q }}">–û—Ç–∫—Ä—ã—Ç—å –≤ Apple Maps</a>
									<a class="btn btn--soft" target="_blank" rel="noopener" href="https://yandex.ru/maps/?rtext=~{{ q }}&rtt=auto">–û—Ç–∫—Ä—ã—Ç—å –≤ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç–∞—Ö</a>
								</div>
							{% endif %}
						</div>
					{% endif %}
				</div>
			</section>
		{% endif %}

		<footer class="footer">
			<div class="container footer__row">
				<div class="footer__copy">¬©
					{{ "now"|date("Y") }}
					{{ userPage.companyName|default(userPage.title)|default('') }}</div>
				<a class="header__back" href="{{ path('app_profile') }}">‚Üê –í –ø—Ä–æ—Ñ–∏–ª—å</a>
			</div>
		</footer>

		{# JSON-LD (–±–µ–∑ –ø–∞–¥–µ–Ω–∏–π) #}
		{% set ld = {
      '@context':'https://schema.org',
      '@type':'LocalBusiness',
      'name': userPage.companyName|default(userPage.title|default('')),
      'url': app is defined and app.request ? app.request.uri : ''
    } %}
		{% if ogImage %}
			{% set ld = ld|merge({'image': ogImage}) %}
		{% endif %}
		{% if userPage.phone %}
			{% set ld = ld|merge({'telephone': userPage.phone}) %}
		{% endif %}
		{% if userPage.email %}
			{% set ld = ld|merge({'email': userPage.email}) %}
		{% endif %}
		{% if userPage.adress %}
			{% set ld = ld|merge({'address': {'@type':'PostalAddress','streetAddress': userPage.adress}}) %}
		{% endif %}
		{% if hasMap %}
			{% set ld = ld|merge({'geo': {'@type':'GeoCoordinates','latitude': lat,'longitude': lng}}) %}
		{% endif %}
		<script type="application/ld+json">{{ ld|json_encode(constant('JSON_UNESCAPED_UNICODE'))|raw }}</script>

		<script defer src="{{ asset('js/user_page_public.js') }}"></script>
	</body>
</html>
